<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡πÑ‡∏ó‡∏¢</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Kanit', sans-serif;
            background-color: #1a202c; /* A dark, elegant background */
        }
        .card {
            background-color: transparent;
            width: 100%;
            height: 120px;
            perspective: 1000px;
            cursor: pointer;
        }
        .card-inner {
            position: relative;
            width: 100%;
            height: 100%;
            text-align: center;
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .card.flipped .card-inner {
            transform: rotateY(180deg);
        }
        .card-front, .card-back {
            position: absolute;
            width: 100%;
            height: 100%;
            -webkit-backface-visibility: hidden; /* Safari */
            backface-visibility: hidden;
            border-radius: 0.75rem;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0.5rem;
        }
        .card-front {
            background-color: #4a5568;
            color: white;
            transform: rotateY(180deg);
        }
        .card-back {
            background-color: #97266d;
            background-image: 
                linear-gradient(135deg, rgba(255, 255, 255, .05) 25%, transparent 25%),
                linear-gradient(225deg, rgba(255, 255, 255, .05) 25%, transparent 25%),
                linear-gradient(45deg, rgba(255, 255, 255, .05) 25%, transparent 25%),
                linear-gradient(315deg, rgba(255, 255, 255, .05) 25%, #97266d 25%);
            background-position: 10px 0, 10px 0, 0 0, 0 0;
            background-size: 20px 20px;
            background-repeat: repeat;
            color: #f7fafc;
            font-size: 2rem;
        }
        .card.matched .card-front {
            background-color: #2f855a;
            opacity: 0.9;
        }
        .card.matched .card-inner {
            transform: rotateY(180deg);
        }
        #gemini-modal-content {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        #gemini-modal.show #gemini-modal-content {
            transform: scale(1);
            opacity: 1;
        }
    </style>
</head>
<body class="bg-slate-900 text-white min-h-screen flex flex-col items-center justify-center p-4">

    <div class="w-full max-w-4xl mx-auto">
        <header class="text-center mb-4">
            <h1 class="text-4xl md:text-5xl font-bold text-amber-300">‡πÄ‡∏Å‡∏°‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏•‡∏∞‡∏Ñ‡∏£‡πÑ‡∏ó‡∏¢</h1>
            <p class="text-slate-300 mt-2">‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ç‡∏≠‡∏á‡∏•‡∏∞‡∏Ñ‡∏£‡∏Å‡∏±‡∏ö‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
            <pclass="text-slate-300 mt-2">‡∏à‡∏±‡∏î‡∏ó‡∏≥‡πÇ‡∏î‡∏¢ ‡∏ê‡∏≤‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏ô‡∏±‡∏ô‡∏ï‡πå‡∏ò‡∏ô‡∏≤‡∏•‡∏¥‡∏ô‡∏ï‡πå ‡∏°.5/4 ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà 12</p>
            <!-- Stats Container -->
            <div id="stats-container" class="mt-4 flex justify-center gap-6 text-lg text-slate-200">
                <p>‡πÄ‡∏ß‡∏•‡∏≤: <span id="timer" class="font-semibold text-amber-300">00:00</span></p>
                <p>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î: <span id="move-counter" class="font-semibold text-amber-300">0</span></p>
            </div>
        </header>

        <main id="game-board" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mb-6">
            <!-- Cards are generated by JavaScript -->
        </main>

        <div class="text-center mb-6">
            <p id="status-message" class="text-xl h-8 text-green-400 font-semibold"></p>
            <div id="button-container" class="mt-4 flex flex-col sm:flex-row justify-center items-center gap-4">
                <button id="reset-button" class="w-full sm:w-auto px-8 py-3 bg-rose-600 hover:bg-rose-700 text-white font-bold rounded-lg shadow-lg transition-transform transform hover:scale-105">
                    ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
                </button>
                <button id="gemini-button" class="hidden w-full sm:w-auto px-8 py-3 bg-teal-500 hover:bg-teal-600 text-white font-bold rounded-lg shadow-lg transition-transform transform hover:scale-105">
                    ‚ú® ‡∏Ç‡∏≠‡πÄ‡∏Å‡∏£‡πá‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‚ú®
                </button>
            </div>
        </div>
    </div>

       <!-- Modal for Gemini Fun Fact -->
    <div id="gemini-modal" class="fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-slate-800 rounded-2xl shadow-2xl w-full max-w-lg p-6 relative transform transition-all scale-95 opacity-0" id="gemini-modal-content">
            <button id="close-modal-button" class="absolute top-3 right-4 text-slate-400 hover:text-white text-3xl font-light">&times;</button>
            <h2 class="text-2xl font-bold text-amber-300 mb-4">‚ú® ‡πÄ‡∏Å‡∏£‡πá‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏à‡∏≤‡∏Å Gemini ‚ú®</h2>
            <div id="gemini-loading" class="text-center py-8 hidden">
                 <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-amber-300 mx-auto"></div>
                 <p class="mt-4 text-slate-300">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </div>
            <div id="gemini-result" class="text-slate-200 text-lg leading-relaxed min-h-[100px]"></div>
        </div>
    </div>

    <script>
        // --- Game Data ---
        const dramaPairs = [
            { id: 1, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡∏ä‡∏≤‡∏ï‡∏£‡∏µ', name: '‡∏°‡πÇ‡∏ô‡∏´‡πå‡∏£‡∏≤' },
            { id: 2, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡∏ô‡∏≠‡∏Å', name: '‡∏™‡∏±‡∏á‡∏Ç‡πå‡∏ó‡∏≠‡∏á' },
            { id: 3, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡πÉ‡∏ô', name: '‡∏£‡∏≤‡∏°‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡πå' },
            { id: 4, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡∏î‡∏∂‡∏Å‡∏î‡∏≥‡∏ö‡∏£‡∏£‡∏û‡πå', name: '‡∏Ñ‡∏≤‡∏ß‡∏µ' },
            { id: 5, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡∏û‡∏±‡∏ô‡∏ó‡∏≤‡∏á', name: '‡∏£‡∏≤‡∏ä‡∏≤‡∏ò‡∏¥‡∏£‡∏≤‡∏ä' },
            { id: 6, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡∏£‡πâ‡∏≠‡∏á', name: '‡∏™‡∏≤‡∏ß‡πÄ‡∏Ñ‡∏£‡∏∑‡∏≠‡∏ü‡πâ‡∏≤' },
            { id: 7, type: '‡∏•‡∏∞‡∏Ñ‡∏£‡∏û‡∏π‡∏î', name: '‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏ô‡∏±‡∏Å‡∏£‡∏ö' }
        ];

        // --- DOM Elements ---
        const gameBoard = document.getElementById('game-board');
        const statusMessage = document.getElementById('status-message');
        const resetButton = document.getElementById('reset-button');
        const geminiButton = document.getElementById('gemini-button');
        const geminiModal = document.getElementById('gemini-modal');
        const closeModalButton = document.getElementById('close-modal-button');
        const geminiLoading = document.getElementById('gemini-loading');
        const geminiResult = document.getElementById('gemini-result');
        const timerElement = document.getElementById('timer');
        const moveCounterElement = document.getElementById('move-counter');

        // --- Game State ---
        let cards = [];
        let flippedCards = [];
        let matchedPairs = 0;
        let lockBoard = false;
        let moves = 0;
        let seconds = 0;
        let timerInterval = null;
        let gameStarted = false;

        // --- Functions ---
        function shuffle(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }

        function createBoard() {
            // Reset game state
            matchedPairs = 0;
            lockBoard = false;
            gameStarted = false;
            statusMessage.textContent = '';
            gameBoard.innerHTML = '';
            geminiButton.classList.add('hidden');
            
            // Reset stats
            resetStats();

            // Create card data
            const cardDataArray = [];
            dramaPairs.forEach(pair => {
                cardDataArray.push({ text: pair.type, id: pair.id });
                cardDataArray.push({ text: pair.name, id: pair.id });
            });

            shuffle(cardDataArray);

            // Create card elements
            cardDataArray.forEach(cardData => {
                const cardElement = document.createElement('div');
                cardElement.classList.add('card');
                cardElement.dataset.id = cardData.id;
                cardElement.innerHTML = `
                    <div class="card-inner">
                        <div class="card-back"><span>üé≠</span></div>
                        <div class="card-front"><span class="text-base md:text-lg font-semibold">${cardData.text}</span></div>
                    </div>`;
                cardElement.addEventListener('click', handleCardClick);
                gameBoard.appendChild(cardElement);
            });
        }

        function handleCardClick(event) {
            if (lockBoard) return;
            const clickedCard = event.currentTarget;
            if (clickedCard.classList.contains('flipped') || clickedCard.classList.contains('matched')) return;

            if (!gameStarted) {
                startTimer();
                gameStarted = true;
            }
            
            incrementMoveCounter();
            flipCard(clickedCard);
            
            if (flippedCards.length === 2) {
                checkForMatch();
            }
        }
        
        function incrementMoveCounter() {
            moves++;
            moveCounterElement.textContent = moves;
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                seconds++;
                const minutes = Math.floor(seconds / 60).toString().padStart(2, '0');
                const remainingSeconds = (seconds % 60).toString().padStart(2, '0');
                timerElement.textContent = `${minutes}:${remainingSeconds}`;
            }, 1000);
        }

        function stopTimer() {
            clearInterval(timerInterval);
        }

        function resetStats() {
            stopTimer();
            seconds = 0;
            moves = 0;
            timerElement.textContent = '00:00';
            moveCounterElement.textContent = '0';
        }

        function flipCard(card) {
            card.classList.add('flipped');
            flippedCards.push(card);
        }

        function checkForMatch() {
            lockBoard = true;
            const [cardOne, cardTwo] = flippedCards;
            
            if (cardOne.dataset.id === cardTwo.dataset.id) {
                disableCards();
            } else {
                unflipCards();
            }
        }

        function disableCards() {
            const [cardOne, cardTwo] = flippedCards;
            cardOne.classList.add('matched');
            cardTwo.classList.add('matched');
            matchedPairs++;
            resetBoardState();

            if (matchedPairs === dramaPairs.length) {
                stopTimer();
                setTimeout(() => {
                    statusMessage.textContent = '‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏î‡πâ‡∏ß‡∏¢! ‡∏Ñ‡∏∏‡∏ì‡∏ä‡∏ô‡∏∞‡πÅ‡∏•‡πâ‡∏ß!';
                    geminiButton.classList.remove('hidden');
                }, 500);
            }
        }

        function unflipCards() {
            setTimeout(() => {
                const [cardOne, cardTwo] = flippedCards;
                cardOne.classList.remove('flipped');
                cardTwo.classList.remove('flipped');
                resetBoardState();
            }, 1200);
        }

        function resetBoardState() {
            flippedCards = [];
            lockBoard = false;
        }

        // --- Gemini API Functions ---
        async function callGeminiAPI(dramaName) {
            const prompt = `‡πÄ‡∏•‡πà‡∏≤‡πÄ‡∏Å‡∏£‡πá‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏±‡πâ‡∏ô‡πÜ ‡∏ó‡∏µ‡πà‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏•‡∏∞‡∏Ñ‡∏£‡πÑ‡∏ó‡∏¢‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á '${dramaName}' ‡πÉ‡∏´‡πâ‡∏´‡∏ô‡πà‡∏≠‡∏¢ ‡∏Ç‡∏≠‡πÅ‡∏ö‡∏ö‡∏¢‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡πÅ‡∏•‡∏∞‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5 ‡∏ö‡∏£‡∏£‡∏ó‡∏±‡∏î‡πÉ‡∏ô‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢`;
            geminiResult.innerHTML = '';
            geminiLoading.style.display = 'block';

            try {
                const chatHistory = [{ role: "user", parts: [{ text: prompt }] }];
                const payload = { contents: chatHistory };
                const apiKey = "";
                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) throw new Error(`API error! status: ${response.status}`);
                const result = await response.json();
                
                let text = '‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢ ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ‡πÉ‡∏ô‡∏Ç‡∏ì‡∏∞‡∏ô‡∏µ‡πâ';
                if (result.candidates?.[0]?.content?.parts?.[0]?.text) {
                    text = result.candidates[0].content.parts[0].text;
                }
                geminiResult.innerHTML = text.replace(/\n/g, '<br>');

            } catch (error) {
                console.error("Gemini API call failed:", error);
                geminiResult.innerHTML = '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö AI ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡πÉ‡∏ô‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á';
            } finally {
                geminiLoading.style.display = 'none';
            }
        }

        function showModal() {
            const modal = document.getElementById('gemini-modal');
            modal.classList.remove('hidden');
            setTimeout(() => modal.querySelector('#gemini-modal-content').classList.add('show'), 10);
        }

        function hideModal() {
            const modal = document.getElementById('gemini-modal');
            modal.querySelector('#gemini-modal-content').classList.remove('show');
            setTimeout(() => modal.classList.add('hidden'), 300);
        }

        // --- Event Listeners ---
        resetButton.addEventListener('click', createBoard);
        geminiButton.addEventListener('click', () => {
            const randomDrama = dramaPairs[Math.floor(Math.random() * dramaPairs.length)];
            showModal();
            callGeminiAPI(randomDrama.name);
        });
        closeModalButton.addEventListener('click', hideModal);
        geminiModal.addEventListener('click', (event) => {
            if (event.target === geminiModal) hideModal();
        });

        // --- Initial Game Start ---
        document.addEventListener('DOMContentLoaded', createBoard);
    </script>
</body>
</html>
